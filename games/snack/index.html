<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snake</title>
</head>
<body>
<div class="game" style="display: flex">
  <canvas id="can" width="400" height="400" style="background:#f6f6f6"></canvas>
  <div class="container" style="flex: 1; text-align: center; border: 1px solid #aaa;">
    <p>经典游戏贪吃蛇。</p>
    <marquee behavior="alternate">
      帅的人已经醒来~~~<br>
      　　　∩∩<br>
      　　（´･ω･）<br>
      　 ＿|　⊃／(＿＿_<br>
      　／ └-(＿＿＿_／<br>
      　￣￣￣￣￣￣￣<br>

      丑的人还在沉睡~~~<br>
      　　 ⊂⌒／ヽ-、＿_<br>
      　／⊂_/＿＿＿＿ ／<br>
      　￣￣￣￣￣￣￣<br>
    </marquee>
    <div class="text" style="font-size: 28px; border-top: 1px solid #aaa; padding-top: 10px;">得分：<span id="score">0</span></div>
    <button class="jiasu" style="background: #222;
                                display: inline-block;
                                padding: 5px 10px 6px;
                                color: #fff;
                                margin: 10px;
                                text-decoration: none;
                                -moz-border-radius: 6px;
                                -webkit-border-radius: 6px;
                                -moz-box-shadow: 0 1px 3px rgba(0,0,0,0.6);
                                -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.6);
                                text-shadow: 0 -1px 1px rgba(0,0,0,0.25);
                                border-bottom: 1px solid rgba(0,0,0,0.25);
                                position: relative;
                                cursor: pointer;" 
                                onclick=" if(speed - 50 <= 0 ) alert('最大速度');speed = speed - 50" >加速</button>
    <button class="jiansu" style="display: inline-block;
                                padding: 5px 10px 6px;
                                color: #fff;
                                margin: 10px;
                                text-decoration: none;
                                -moz-border-radius: 6px;
                                -webkit-border-radius: 6px;
                                -moz-box-shadow: 0 1px 3px rgba(0,0,0,0.6);
                                -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.6);
                                text-shadow: 0 -1px 1px rgba(0,0,0,0.25);
                                border-bottom: 1px solid rgba(0,0,0,0.25);
                                position: relative;
                                cursor: pointer;"
                                onclick="speed = speed + 50">减速</button>
  </div>
</div>
<script>
  var speed = 300;
  var score = -10;
  var sn=[42,41],dz=43,fx=1,n,ctx=document.getElementById("can").getContext("2d");
  function draw(t,c,r){
    ctx.fillStyle=c;
    ctx.beginPath();
    ctx.arc(t%20*20+1,~~(t/20)*20+1,r || 10,0,360,false);
    ctx.fill();//画实心圆
    ctx.closePath();
  }

  function drawSn(t,c,r){
    ctx.fillStyle=c;
    ctx.beginPath();
    ctx.arc(t%20*20+1,~~(t/20)*20+1,r || 10,0,360,false);
    ctx.fill();//画实心圆
    ctx.closePath();

    ctx.fillStyle='rgba(255, 0, 0 , 1)';
    ctx.beginPath();
    ctx.arc(t%20*20+1,~~(t/20)*20+1,5,0,360,false);
    ctx.fill();//画实心圆
    ctx.closePath();
  }
  document.onkeydown=function(e){
    var x = sn[1]-sn[0]; 
    if( (e.keyCode === 37) || (e.keyCode === 65) ) fx=sn[1]-sn[0]==(n=-1||fx)?fx:n;
    if( (e.keyCode === 38) || (e.keyCode === 87) ) fx=sn[1]-sn[0]==(n=-20||fx)?fx:n;
    if( (e.keyCode === 39) || (e.keyCode === 68) ) fx=sn[1]-sn[0]==(n=1||fx)?fx:n;
    if( (e.keyCode === 40) || (e.keyCode === 83) ) fx=sn[1]-sn[0]==(n=20||fx)?fx:n;
  };
  !function(){
    sn.unshift(n=sn[0]+fx);
    if(sn.indexOf(n,1)>0 || n<0||n>399||fx==1&&n%20==0||fx==-1&&n%20==19) return alert("GAME OVER");
    drawSn(n, "rgba(255, 0, 0 , 0.7)");
    if(n==dz){
      // debugger
      score = score + 10;
      document.getElementById('score').innerHTML = score;
      while(sn.indexOf(dz=~~(Math.random()*400))>=0);
      var color = ["aqua", "blue", "fuchsia", "gray", "green", "lime", "maroon", "navy", "purple", "teal"];
      draw(dz, color[Math.floor(Math.random()*10)], 8);
    }else{
      draw(sn.pop(),"#f6f6f6", 11);
    }
    setTimeout(arguments.callee, speed);
  }();
</script> 
</body>
</html>